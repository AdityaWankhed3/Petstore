{% extends "petapp/base.html" %}
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>PetStore</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="{% static 'assets/img/favicon.png' %}" rel="icon">
    <link href="{% static 'assets/img/apple-touch-icon.png' %}" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="{% static 'https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i' %}" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
    <link href="{% static 'assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
    <link href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
    <link href="{% static 'assets/vendor/remixicon/remixicon.css' %}" rel="stylesheet">
    <link href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet"> '
    <!-- Template Main CSS File -->
    <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">

    <!-- =======================================================
  * Template Name: Tempo
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/tempo-free-onepage-bootstrap-theme/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
    {% block header %}
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top ">
        <div class="container d-flex align-items-center justify-content-between">

            <h1 class="logo"> <a href='{% url "home"  %}' class="logo"><img src="{% static 'assets/img/logo.png' %}" alt="" class="img-fluid"></a><a href='{% url "home"  %}'>PetStore</a></h1>
            <!-- Uncomment below if you prefer to use an image logo -->
             

            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link scrollto active" href="#hero">Home</a></li>
                    <li><a class="nav-link scrollto" href="#about">About</a></li>
                    <li><a class="nav-link scrollto" href="#services">Services</a></li>
                    <li><a class="nav-link scrollto" href="{% url 'contact' %}">Contact</a></li>
                    <li class="dropdown"><a href="#"><span>Sign IN</span> <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a href='{% url "signup"  %}'>Sign UP</a></li>
                            </li>
                            <li><a href='{% url "handlelogin"  %}'>Login in</a></li>
                            <li><a href='{% url "handlelogin"  %}'>Logout</a></li>
                        </ul>
                    </li>
                    <button type="button" class="nav-link scrollto bg-danger p-3 m-2 text-white" id="popcart" data-container="body" data-bs-toggle="popover" data-bs-title="Popover title" data-placement="bottom" data-html="true">Cart(<span id="cart">0</span>)</button>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav>
            <!-- .navbar -->

        </div>
    {% endblock header %}
    </header>
    <!-- End Header -->
    
   

    <!-- ======= Hero Section ======= -->
    <section id="hero">
        <div class="hero-container">
            {% block content %}
            <h3>Welcome to <strong>PetStore</strong></h3>
            <h1>We're PetShop Agency</h1>
            <h2>We have talented pets </h2>
            <a href='{% url "signup"  %}' class="btn-get-started scrollto">Click for Surprise</a>
            {% endblock content %}
            {% block body %}
            <!-- ======= Portfolio Section ======= -->
    <section id="portfolio" class="portfolio">
        <div class="container">
            <div class="section-title">
                <h2>Welcome To Our Shop</h2>
                <h3>Check our <span>Products</span></h3>
                <p>Wish You A Happy New Year.</p>
                </div>

                {% for product, range, nSlides in allProds %}
<div class="container">
    <h3 class="my-3 text-center text-sucess bg-light">
    {{product.0.category}} Flashsale
    </h3>
</div>
<div class="container">
    <div class="row">
    {% for i in product%}
    <div class="col-md-3 mt-3">
        <img src="/media/{{i.image}}" alt="..." class="card-img-top" />
        <div class="card-body">
        <h5 class="card-title" id="namepr{{i.id}}">{{i.product_name}}</h5>
        <p class="card-text">{{i.desc|slice:"0.53"}}...</p>
        <h6 class="card-title">
            Price: <span id="pricepr{{i.id}}"> {{i.price}}</span>
        </h6>
        <span id="divpr{{i.id}}" class="divpr">
            <button class="btn btn-success cart btn-sm mt-0" id="pr{{i.id}}">
                AddToCart
            </button>
        </span>            
        <a href="/media/{{i.image}}"
            ><button class="btn btn-success btn-sm cart">View</button></a
        >
        </div>
    </div>
    {% endfor%}
    </div>
</div>
    {% endfor %}

                

            </div>
        </section>
        <!-- End Portfolio Section -->
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>



<script>
    //find out the cart from  local storage
    if (localStorage.getItem('cart')==null){
      var cart={};
    }
    else{
      cart=JSON.parse(localStorage.getItem('cart'))
      updateCart(cart);
    }
    function updateCart(cart){
        var sum =0;
        for(var item in cart){
          sum=sum+cart[item][0];
          document.getElementById('div'+item).innerHTML="<button id ='minus" + item + "'class='btn btn-success minus'>-</button> <span id='val"+item+"''>"+cart[item][0]+"</span> <button id='plus"+ item + "' class='btn btn-success plus'>+</button>";
        }
        localStorage.setItem('cart',JSON.stringify(cart));
        document.getElementById("cart").innerHTML=sum;
        console.log(cart);
        updatePopover(cart);
        document.getElementById("popcart").click();
      }
    //add or increment code
    //$('.cart').click(function()
    $('.divpr').on('click', 'button.cart', function() {
        var idstr=this.id.toString();
        console.log(idstr)
        if(cart[idstr]!==undefined) {
          qty=cart[idstr][0]+1;
        }
        else{
          qty=1;
          name=document.getElementById('name'+idstr).innerHTML;
          price=document.getElementById('price'+idstr).innerHTML;
          cart[idstr]=[qty,name,price];
        }
        updateCart(cart);
        localStorage.setItem('cart',JSON.stringify(cart));
        document.getElementById("cart").innerHTML=Object.keys(cart).length;
        console.log(Object.keys(cart).length)
        document.getElementById("popcart").click();
  
    }));
    //add popover to cart
  
    $('#popcart').popover();
    updatePopover(cart);
    function updatePopover(cart) {
        console.log('we are inside update popover');
        var popStr = "";
        popStr += "<h5>Cart for your items in my shopping cart</h5><div class='mx-2 my-2'>";
        var i = 1;
        for (var item in cart) {
            popStr += "<b>" + i + "</b>.";
            popStr += document.getElementById('name' + item).innerHTML.slice(0, 19) + "..." + "<b>" + cart[item][0] + "</b>" + "qty" + '<br>';
            i = i + 1;
        }
        popStr += "</div><a href='/checkout'><button class='btn btn-dark' onclick='clearCart()' id='clearCart'>ClearCart</button>";
        document.getElementById('popcart').setAttribute('data-content', popStr);
        $('#popcart').popover('show');
        document.getElementById("popcart").click();
    }
    
    function clearCart(){
          cart=JSON.parse(localStorage.getItem('cart'));
          for(var item in cart){
              document.getElementById('div'+item).innerHTML='<button id=""' + item + '"class="btn-succcess cart ">Add to Cart</button>'
          }
          localStorage.clear();
          cart={};
          updateCart(cart);
        let clear=document.getElementById("popcart").click();
        document.getElementById("popcart").click();
    }
  </script>

            {% endblock body %}

            
        </div>
        
    </section>
    <!-- End Hero -->

    <main id="main">
    </main>
    
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    {% block footer %}
    <footer id="footer">
        <div class="footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-3 col-md-6 footer-contact">
                        <h3>PetStore</h3>
                        <p>
                            BTM STAGE 1 <br> @nd floor<br> Bangalore <br><br>
                            <strong>Phone:</strong> +91 9921049172<br>
                            <strong>Email:</strong> adityawankhede786@gmail.com<br>
                        </p>
                    </div>

                    <div class="col-lg-2 col-md-6 footer-links">
                        <h4>Useful Links</h4>
                        <ul>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-3 col-md-6 footer-links">
                        <h4>Our Services</h4>
                        <ul>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Free check up for pets</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Grooming of pets</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Home delivery of pet products</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Coupons</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Burial care</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-6 footer-newsletter">
                        <h4>Join Our Protest</h4>
                        <p>Lets save our sad ones and provide them a home and give them shelter, be a part of donator.</p>
                        <form action="" method="post">
                            <input type="type" name="type"><input type="submit" value="Donate">
                        </form>
                    </div>

                </div>
            </div>
        </div>

        <div class="container d-md-flex py-4">

            <div class="me-md-auto text-center text-md-start">
                <div class="copyright">
                    &copy; Copyright <strong><span>PetStore</span></strong>. All Rights Reserved
                </div>
                <div class="credits">
                    <!-- All the links in the footer should remain intact. -->
                    <!-- You can delete the links only if you purchased the pro version. -->
                    <!-- Licensing information: https://bootstrapmade.com/license/ -->
                    <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/tempo-free-onepage-bootstrap-theme/ -->
                    Designed by <a href="https://bootstrapmade.com/">Aditya Wankhede</a>
                </div>
            </div>
            <div class="social-links text-center text-md-right pt-3 pt-md-0">
                <a href="https://twitter.com/addywankhede" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="https://www.facebook.com/aa000y/" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="https://www.instagram.com/addy_wankhede/" class="instagram"><i class="bx bxl-instagram"></i></a>
                <a href="https://github.com/AdityaWankhed3" class="google-plus"><i class="bx bxl-github"></i></a>
                <a href="https://www.linkedin.com/in/aditya-wankhede-a2b99a190/" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
        </div>
    </footer>
    {% endblock footer %}
    <!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>
    <script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
    <script src="{% static 'assets/vendor/swiper/swiper-bundle.min.js'%}"></script>
    <script src="{% static 'assets/vendor/php-email-form/validate.js'%}"></script>

    <!-- Template Main JS File -->
    <script src="{% static 'assets/js/main.js'%}"></script>
</body>

</html>